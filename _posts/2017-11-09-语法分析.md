---
layout:     post
title:      语法分析程序
subtitle:   使用LL(1)文法
date:       2017-11-03
author:     Awybupt
header-img: img/page-CL.jpg
catalog: true
tags:
    - 编译原理
    - C++
---
# 语法分析程序题目
* 编写语法分析程序,实现对算数表达式的语法分析.
    * 表达式由如下文法产生
        * E->E+T|E-T|T
        * T->T*F|T/F|F
        * F->id|(E)|num
        
* 要想使用LL(1)文法必须先把文法转换为无左递归文法,无左公因子手工转换后得到如下文法
    * E->TD
    * D->+TD|-TD|e
    * T->FB
    * B->*FB|/FB|e
    * F->d|(E)|n
    
#### 分别求出如上文法的FIRST集和FOLLOW集,得到如下文法

   VN    | First | FOLLOW
------ | ------ | --------
E | d,(,n |  s,)
D | +,-,e |  s,)
T | d,(,n |  +,-
B | *,/,e |  +,-
F | d,(,n |  *,/

----------
* 然后通过这段代码构造出LL(1)分析表

```c++
        for(文法G的每个产生式A->a){
            for(每个终结符号a->FIRST(A))
                把A->a放入M[A,a]中;
            if(e<FIRST(A))
                for(任何b<FOLLOW(A))
                    把A->a放入M[A,b]中;
        }
        for{所有无定义的M[A,a]}标上错误标志;            
```


```C++
void excel::gene(){
    for(auto se:TT){
        for(auto fi:se.first){
            if(fi=='e'){
                for(auto fo:se.follow){
                    analysistable.insert(pair<loc,string>(loc(se.nt,fo),"e"));
                }
            }
            else{
                int choice=0;//choice
                int temp=(int)(se.production).size();
                for(int i=0;i<temp;i++){
                    if(se.production[i][0]==fi){
                        choice=i;
                    }
                }
                analysistable.insert(pair<loc,string>(loc((se.nt),fi),se.production[choice]));
            }
        }
    }
}
```
* 通过这段代码使用分析表分析

* 算法思想

        
    ```c++
        do{
            令X是栈顶文法符号,a是ip所指向的输入符号;
            if(X是终结符号或$)
                if(X==a){从栈顶弹出X;ip前移一个位置;}
                else error();
            else
                if(M[X,a]=X->Y1Y2...Yk){
                    从栈顶弹出X;
                    把Yk,Yk-1...Y2,Y1压入栈,Y1在栈顶;
                    输出产生式X->Y1Y2...Yk;
                };
                else error();
        }while(X!=$)
    ```


```C++
void excel::Syntaxanalysis(string analytarget){
    analytarget=analytarget+'s';
    string stak="sE";
    do{
        char X=youzhanding(stak);
        char A=zuozhanding(analytarget);
        if(judgeVT(X))
        {
            if(X==A)
            {
                stak=youtanzhan(stak);
                analytarget=zuotanzhan(analytarget);
            }
            else{
                cout<<"error!"<<endl;
                break;
            }
        }
        else{
            string wtemp=searchgene(X, A);
            if(wtemp.size()>0){
                stak=youtanzhan(stak);
                wtemp=strrev(wtemp);
                stak=youruzhan(stak, wtemp);
                cout<<X<<"->"<<strrev(wtemp)<<endl;
                
            }
            else{
                cout<<"error!"<<endl;
                break;
            }
        }
        
    }while(!(stak=="s"&&analytarget=="s"));
}
```




